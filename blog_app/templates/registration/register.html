{% extends 'base.html' %}

{% block title %}Inscription - Ndoti Blog{% endblock %}

{% block content %}
<div class="ndoti-register-page">
    <div class="container">
        <div class="row justify-content-center align-items-center min-vh-100">
            <div class="col-lg-6 col-md-8 col-sm-10">
                <!-- Card d'inscription -->
                <div class="ndoti-register-card">
                    <!-- En-tête avec logo et titre -->
                    <div class="ndoti-register-header">
                        <div class="ndoti-logo-container">
                            <div class="ndoti-logo-circle">
                                <i class="fas fa-users"></i>
                            </div>
                        </div>
                        <h2 class="ndoti-register-title">Rejoignez Ndoti</h2>
                        <p class="ndoti-register-subtitle">Créez votre compte et commencez votre aventure avec nous</p>
                    </div>

                    <!-- Formulaire d'inscription -->
                    <div class="ndoti-register-form-container">
                        <form method="post" class="ndoti-register-form">
                            {% csrf_token %}
                            
                            <!-- Messages d'erreur généraux -->
                            {% if form.non_field_errors %}
                                <div class="ndoti-alert ndoti-alert-error">
                                    <i class="fas fa-exclamation-circle"></i>
                                    <div>
                                        {% for error in form.non_field_errors %}
                                            <p class="mb-0">{{ error }}</p>
                                        {% endfor %}
                                    </div>
                                </div>
                            {% endif %}

                            <!-- Champs du formulaire -->
                            {% for field in form %}
                                <div class="ndoti-form-group">
                                    <label class="ndoti-form-label" for="{{ field.id_for_label }}">
                                        {% if field.name == 'username' %}
                                            <i class="fas fa-user"></i>
                                        {% elif field.name == 'email' %}
                                            <i class="fas fa-envelope"></i>
                                        {% elif field.name == 'first_name' %}
                                            <i class="fas fa-id-card"></i>
                                        {% elif field.name == 'last_name' %}
                                            <i class="fas fa-id-card"></i>
                                        {% elif 'password' in field.name %}
                                            <i class="fas fa-lock"></i>
                                        {% else %}
                                            <i class="fas fa-info-circle"></i>
                                        {% endif %}
                                        {{ field.label }}
                                        {% if field.field.required %}
                                            <span class="ndoti-required">*</span>
                                        {% endif %}
                                    </label>
                                    
                                    <div class="ndoti-input-wrapper">
                                        {% if field.name == 'username' %}
                                            <input type="text" name="{{ field.name }}" id="{{ field.id_for_label }}" 
                                                   class="ndoti-form-input" placeholder="Choisissez un nom d'utilisateur unique"
                                                   value="{{ field.value|default:'' }}" required>
                                        {% elif field.name == 'email' %}
                                            <input type="email" name="{{ field.name }}" id="{{ field.id_for_label }}" 
                                                   class="ndoti-form-input" placeholder="votre.email@exemple.com"
                                                   value="{{ field.value|default:'' }}">
                                        {% elif field.name == 'first_name' %}
                                            <input type="text" name="{{ field.name }}" id="{{ field.id_for_label }}" 
                                                   class="ndoti-form-input" placeholder="Votre prénom"
                                                   value="{{ field.value|default:'' }}">
                                        {% elif field.name == 'last_name' %}
                                            <input type="text" name="{{ field.name }}" id="{{ field.id_for_label }}" 
                                                   class="ndoti-form-input" placeholder="Votre nom de famille"
                                                   value="{{ field.value|default:'' }}">
                                        {% elif field.name == 'password1' %}
                                            <input type="password" name="{{ field.name }}" id="{{ field.id_for_label }}" 
                                                   class="ndoti-form-input" placeholder="Créez un mot de passe sécurisé" required>
                                            <button type="button" class="ndoti-password-toggle" onclick="togglePassword('{{ field.id_for_label }}', 'toggle1')">
                                                <i class="fas fa-eye" id="toggle1"></i>
                                            </button>
                                        {% elif field.name == 'password2' %}
                                            <input type="password" name="{{ field.name }}" id="{{ field.id_for_label }}" 
                                                   class="ndoti-form-input" placeholder="Confirmez votre mot de passe" required>
                                            <button type="button" class="ndoti-password-toggle" onclick="togglePassword('{{ field.id_for_label }}', 'toggle2')">
                                                <i class="fas fa-eye" id="toggle2"></i>
                                            </button>
                                        {% else %}
                                            {{ field }}
                                        {% endif %}
                                    </div>
                                    
                                    <!-- Texte d'aide -->
                                    {% if field.help_text %}
                                        <div class="ndoti-help-text">
                                            <i class="fas fa-info-circle"></i>
                                            <span>{{ field.help_text }}</span>
                                        </div>
                                    {% endif %}
                                    
                                    <!-- Erreurs de champ -->
                                    {% if field.errors %}
                                        <div class="ndoti-field-errors">
                                            {% for error in field.errors %}
                                                <small class="ndoti-error-text">
                                                    <i class="fas fa-exclamation-triangle"></i> {{ error }}
                                                </small>
                                            {% endfor %}
                                        </div>
                                    {% endif %}
                                </div>
                            {% endfor %}

                            <!-- Indicateur de force du mot de passe -->
                            <div class="ndoti-password-strength" id="password-strength" style="display: none;">
                                <div class="ndoti-strength-indicator">
                                    <div class="ndoti-strength-bar" id="strength-bar"></div>
                                </div>
                                <span class="ndoti-strength-text" id="strength-text">Faible</span>
                            </div>

                            <!-- Conditions d'utilisation -->
                            <div class="ndoti-terms-section">
                                <div class="ndoti-terms-checkbox">
                                    <input type="checkbox" id="terms" name="terms" class="ndoti-checkbox" required>
                                    <label for="terms" class="ndoti-checkbox-label">
                                        J'accepte les <a href="#" class="ndoti-link">conditions d'utilisation</a> 
                                        et la <a href="#" class="ndoti-link">politique de confidentialité</a> de Ndoti
                                    </label>
                                </div>
                                <div class="ndoti-newsletter-checkbox">
                                    <input type="checkbox" id="newsletter" name="newsletter" class="ndoti-checkbox">
                                    <label for="newsletter" class="ndoti-checkbox-label">
                                        Je souhaite recevoir la newsletter Ndoti avec les dernières actualités
                                    </label>
                                </div>
                            </div>

                            <!-- Bouton d'inscription -->
                            <button type="submit" class="ndoti-register-btn" id="register-btn">
                                <span class="ndoti-btn-text">Créer mon compte</span>
                                <i class="fas fa-user-plus ndoti-btn-icon"></i>
                            </button>
                        </form>
                    </div>

                    <!-- Pied de page avec lien de connexion -->
                    <div class="ndoti-register-footer">
                        <div class="ndoti-divider">
                            <span>ou</span>
                        </div>
                        <p class="ndoti-login-prompt">
                            Vous avez déjà un compte Ndoti ?
                        </p>
                        <a href="{% url 'login' %}" class="ndoti-login-btn">
                            <i class="fas fa-sign-in-alt"></i>
                            Se connecter
                        </a>
                    </div>
                </div>

                <!-- Avantages de rejoindre Ndoti -->
                <div class="ndoti-benefits-section">
                    <h4 class="ndoti-benefits-title">Pourquoi rejoindre Ndoti ?</h4>
                    <div class="ndoti-benefits-grid">
                        <div class="ndoti-benefit-item">
                            <i class="fas fa-heart"></i>
                            <span>Participez à une mission solidaire</span>
                        </div>
                        <div class="ndoti-benefit-item">
                            <i class="fas fa-users"></i>
                            <span>Rejoignez une communauté bienveillante</span>
                        </div>
                        <div class="ndoti-benefit-item">
                            <i class="fas fa-book-open"></i>
                            <span>Accédez à du contenu exclusif</span>
                        </div>
                        <div class="ndoti-benefit-item">
                            <i class="fas fa-star"></i>
                            <span>Contribuez aux rêves d'enfants</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
/* Styles pour la page d'inscription */
.ndoti-register-page {
    background: linear-gradient(135deg, var(--ndoti-green) 0%, var(--ndoti-green-dark) 100%);
    min-height: 100vh;
    padding: 2rem 0;
}

.ndoti-register-card {
    background: var(--ndoti-white);
    border-radius: 20px;
    box-shadow: 0 20px 60px rgba(0, 0, 0, 0.15);
    overflow: hidden;
    position: relative;
}

.ndoti-register-card::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 4px;
    background: linear-gradient(90deg, var(--ndoti-green) 0%, var(--ndoti-yellow) 100%);
}

/* En-tête */
.ndoti-register-header {
    text-align: center;
    padding: 3rem 2rem 2rem;
    background: linear-gradient(135deg, var(--ndoti-gray-50) 0%, var(--ndoti-white) 100%);
}

.ndoti-logo-container {
    margin-bottom: 1.5rem;
}

.ndoti-logo-circle {
    width: 80px;
    height: 80px;
    border-radius: 50%;
    background: linear-gradient(135deg, var(--ndoti-green) 0%, var(--ndoti-green-dark) 100%);
    display: flex;
    align-items: center;
    justify-content: center;
    margin: 0 auto;
    box-shadow: 0 8px 24px rgba(22, 163, 74, 0.3);
}

.ndoti-logo-circle i {
    font-size: 2rem;
    color: var(--ndoti-white);
}

.ndoti-register-title {
    font-size: 1.8rem;
    font-weight: 700;
    color: var(--ndoti-green-dark);
    margin-bottom: 0.5rem;
}

.ndoti-register-subtitle {
    color: var(--ndoti-gray-700);
    font-size: 1rem;
    margin-bottom: 0;
}

/* Formulaire */
.ndoti-register-form-container {
    padding: 2rem;
}

.ndoti-form-group {
    margin-bottom: 1.5rem;
}

.ndoti-form-label {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    font-weight: 600;
    color: var(--ndoti-green-dark);
    margin-bottom: 0.5rem;
    font-size: 0.9rem;
}

.ndoti-required {
    color: #dc2626;
    font-weight: 700;
}

.ndoti-input-wrapper {
    position: relative;
}

.ndoti-form-input {
    width: 100%;
    padding: 1rem 1.25rem;
    border: 2px solid var(--ndoti-gray-100);
    border-radius: 12px;
    font-size: 1rem;
    transition: all 0.3s ease;
    background: var(--ndoti-white);
}

.ndoti-form-input:focus {
    outline: none;
    border-color: var(--ndoti-green);
    box-shadow: 0 0 0 0.2rem rgba(22, 163, 74, 0.15);
    transform: translateY(-2px);
}

.ndoti-form-input::placeholder {
    color: var(--ndoti-gray-700);
}

/* Bouton toggle mot de passe */
.ndoti-password-toggle {
    position: absolute;
    right: 1rem;
    top: 50%;
    transform: translateY(-50%);
    background: none;
    border: none;
    color: var(--ndoti-gray-700);
    cursor: pointer;
    padding: 0.5rem;
    border-radius: 6px;
    transition: all 0.3s ease;
}

.ndoti-password-toggle:hover {
    color: var(--ndoti-green);
    background: var(--ndoti-gray-50);
}

/* Texte d'aide */
.ndoti-help-text {
    display: flex;
    align-items: flex-start;
    gap: 0.5rem;
    margin-top: 0.5rem;
    padding: 0.75rem;
    background: linear-gradient(135deg, #f0f9ff 0%, #ffffff 100%);
    border: 1px solid #bae6fd;
    border-radius: 8px;
    font-size: 0.85rem;
    color: #0369a1;
}

.ndoti-help-text i {
    margin-top: 0.1rem;
    flex-shrink: 0;
}

/* Messages d'erreur */
.ndoti-alert {
    padding: 1rem;
    border-radius: 10px;
    margin-bottom: 1.5rem;
    display: flex;
    align-items: flex-start;
    gap: 0.75rem;
}

.ndoti-alert-error {
    background: linear-gradient(135deg, #fef2f2 0%, #ffffff 100%);
    border: 1px solid #fecaca;
    color: #dc2626;
}

.ndoti-field-errors {
    margin-top: 0.5rem;
}

.ndoti-error-text {
    color: #dc2626;
    display: flex;
    align-items: center;
    gap: 0.25rem;
    font-size: 0.85rem;
}

/* Indicateur de force du mot de passe */
.ndoti-password-strength {
    margin-bottom: 1.5rem;
    padding: 1rem;
    background: var(--ndoti-gray-50);
    border-radius: 10px;
    border: 1px solid var(--ndoti-gray-100);
}

.ndoti-strength-indicator {
    width: 100%;
    height: 6px;
    background: var(--ndoti-gray-100);
    border-radius: 3px;
    overflow: hidden;
    margin-bottom: 0.5rem;
}

.ndoti-strength-bar {
    height: 100%;
    width: 0%;
    transition: all 0.3s ease;
    border-radius: 3px;
}

.ndoti-strength-text {
    font-size: 0.85rem;
    font-weight: 600;
}

/* Conditions d'utilisation */
.ndoti-terms-section {
    margin-bottom: 2rem;
    padding: 1.5rem;
    background: var(--ndoti-gray-50);
    border-radius: 12px;
    border: 1px solid var(--ndoti-gray-100);
}

.ndoti-terms-checkbox,
.ndoti-newsletter-checkbox {
    display: flex;
    align-items: flex-start;
    gap: 0.75rem;
    margin-bottom: 1rem;
}

.ndoti-newsletter-checkbox {
    margin-bottom: 0;
}

.ndoti-checkbox {
    width: 18px;
    height: 18px;
    accent-color: var(--ndoti-green);
    margin-top: 0.1rem;
    flex-shrink: 0;
}

.ndoti-checkbox-label {
    font-size: 0.9rem;
    color: var(--ndoti-gray-700);
    cursor: pointer;
    line-height: 1.4;
}

.ndoti-link {
    color: var(--ndoti-green);
    text-decoration: none;
    font-weight: 500;
}

.ndoti-link:hover {
    color: var(--ndoti-green-dark);
    text-decoration: underline;
}

/* Bouton d'inscription */
.ndoti-register-btn {
    width: 100%;
    background: linear-gradient(135deg, var(--ndoti-green) 0%, var(--ndoti-green-dark) 100%);
    color: var(--ndoti-white);
    border: none;
    padding: 1rem 2rem;
    border-radius: 12px;
    font-size: 1.1rem;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s ease;
    position: relative;
    overflow: hidden;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.75rem;
}

.ndoti-register-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 24px rgba(22, 163, 74, 0.4);
}

.ndoti-register-btn:active {
    transform: translateY(0);
}

.ndoti-register-btn:disabled {
    opacity: 0.6;
    cursor: not-allowed;
    transform: none;
}

/* Pied de page */
.ndoti-register-footer {
    padding: 2rem;
    background: var(--ndoti-gray-50);
    text-align: center;
}

.ndoti-divider {
    position: relative;
    margin-bottom: 1.5rem;
}

.ndoti-divider::before {
    content: '';
    position: absolute;
    top: 50%;
    left: 0;
    right: 0;
    height: 1px;
    background: var(--ndoti-gray-100);
    z-index: 1;
}

.ndoti-divider span {
    background: var(--ndoti-gray-50);
    padding: 0 1rem;
    color: var(--ndoti-gray-700);
    font-size: 0.9rem;
    position: relative;
    z-index: 2;
}

.ndoti-login-prompt {
    color: var(--ndoti-gray-700);
    margin-bottom: 1rem;
    font-size: 0.95rem;
}

.ndoti-login-btn {
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    background: var(--ndoti-yellow);
    color: var(--ndoti-green-darker);
    padding: 0.75rem 1.5rem;
    border-radius: 10px;
    text-decoration: none;
    font-weight: 600;
    font-size: 0.95rem;
    transition: all 0.3s ease;
}

.ndoti-login-btn:hover {
    background: var(--ndoti-yellow-dark);
    color: var(--ndoti-green-darker);
    transform: translateY(-2px);
    box-shadow: 0 6px 20px rgba(251, 191, 36, 0.4);
}

/* Section avantages */
.ndoti-benefits-section {
    margin-top: 2rem;
    text-align: center;
}

.ndoti-benefits-title {
    color: var(--ndoti-white);
    font-size: 1.2rem;
    font-weight: 600;
    margin-bottom: 1.5rem;
}

.ndoti-benefits-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 1rem;
}

.ndoti-benefit-item {
    background: rgba(255, 255, 255, 0.1);
    padding: 1rem;
    border-radius: 10px;
    border: 1px solid rgba(255, 255, 255, 0.2);
    backdrop-filter: blur(10px);
    display: flex;
    align-items: center;
    gap: 0.75rem;
    color: var(--ndoti-white);
    font-size: 0.9rem;
    transition: all 0.3s ease;
}

.ndoti-benefit-item:hover {
    background: rgba(255, 255, 255, 0.15);
    transform: translateY(-2px);
}

.ndoti-benefit-item i {
    color: var(--ndoti-yellow);
    font-size: 1.2rem;
    flex-shrink: 0;
}

/* Responsive */
@media (max-width: 768px) {
    .ndoti-register-page {
        padding: 1rem 0;
    }
    
    .ndoti-register-header {
        padding: 2rem 1.5rem 1.5rem;
    }
    
    .ndoti-register-form-container,
    .ndoti-register-footer {
        padding: 1.5rem;
    }
    
    .ndoti-register-title {
        font-size: 1.5rem;
    }
    
    .ndoti-benefits-grid {
        grid-template-columns: 1fr;
    }
}

@media (max-width: 480px) {
    .ndoti-register-card {
        margin: 0 1rem;
        border-radius: 16px;
    }
    
    .ndoti-logo-circle {
        width: 60px;
        height: 60px;
    }
    
    .ndoti-logo-circle i {
        font-size: 1.5rem;
    }
}
</style>

<script>
// Fonction pour toggle le mot de passe
function togglePassword(fieldId, iconId) {
    const passwordField = document.getElementById(fieldId);
    const toggleIcon = document.getElementById(iconId);
    
    if (passwordField.type === 'password') {
        passwordField.type = 'text';
        toggleIcon.classList.remove('fa-eye');
        toggleIcon.classList.add('fa-eye-slash');
    } else {
        passwordField.type = 'password';
        toggleIcon.classList.remove('fa-eye-slash');
        toggleIcon.classList.add('fa-eye');
    }
}

// Vérification de la force du mot de passe
function checkPasswordStrength(password) {
    let strength = 0;
    let feedback = [];
    
    if (password.length >= 8) strength += 1;
    else feedback.push("Au moins 8 caractères");
    
    if (/[a-z]/.test(password)) strength += 1;
    else feedback.push("Une lettre minuscule");
    
    if (/[A-Z]/.test(password)) strength += 1;
    else feedback.push("Une lettre majuscule");
    
    if (/[0-9]/.test(password)) strength += 1;
    else feedback.push("Un chiffre");
    
    if (/[^A-Za-z0-9]/.test(password)) strength += 1;
    else feedback.push("Un caractère spécial");
    
    return { strength, feedback };
}

// Mise à jour de l'indicateur de force
function updatePasswordStrength(password) {
    const strengthIndicator = document.getElementById('password-strength');
    const strengthBar = document.getElementById('strength-bar');
    const strengthText = document.getElementById('strength-text');
    
    if (password.length === 0) {
        strengthIndicator.style.display = 'none';
        return;
    }
    
    strengthIndicator.style.display = 'block';
    const { strength } = checkPasswordStrength(password);
    
    const colors = ['#dc2626', '#f59e0b', '#eab308', '#22c55e', '#91CD8C'];
    const texts = ['Très faible', 'Faible', 'Moyen', 'Fort', 'Très fort'];
    
    strengthBar.style.width = `${(strength / 5) * 100}%`;
    strengthBar.style.background = colors[strength - 1] || colors[0];
    strengthText.textContent = texts[strength - 1] || texts[0];
    strengthText.style.color = colors[strength - 1] || colors[0];
}

// Validation du formulaire
function validateForm() {
    const termsCheckbox = document.getElementById('terms');
    const registerBtn = document.getElementById('register-btn');
    
    if (termsCheckbox && registerBtn) {
        registerBtn.disabled = !termsCheckbox.checked;
    }
}

// Animation d'entrée
document.addEventListener('DOMContentLoaded', function() {
    const registerCard = document.querySelector('.ndoti-register-card');
    const benefits = document.querySelector('.ndoti-benefits-section');
    
    registerCard.style.opacity = '0';
    registerCard.style.transform = 'translateY(30px)';
    benefits.style.opacity = '0';
    benefits.style.transform = 'translateY(20px)';
    
    setTimeout(() => {
        registerCard.style.transition = 'all 0.6s ease';
        registerCard.style.opacity = '1';
        registerCard.style.transform = 'translateY(0)';
        
        setTimeout(() => {
            benefits.style.transition = 'all 0.6s ease';
            benefits.style.opacity = '1';
            benefits.style.transform = 'translateY(0)';
        }, 200);
    }, 100);
    
    // Écouteurs d'événements
    const password1Field = document.querySelector('input[name="password1"]');
    if (password1Field) {
        password1Field.addEventListener('input', function() {
            updatePasswordStrength(this.value);
        });
    }
    
    const termsCheckbox = document.getElementById('terms');
    if (termsCheckbox) {
        termsCheckbox.addEventListener('change', validateForm);
    }
    
    // Validation initiale
    validateForm();
});
</script>

<!-- Font Awesome pour les icônes -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
{% endblock %}